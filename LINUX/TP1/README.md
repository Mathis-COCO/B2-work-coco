# TP1 : (re)Familiaration avec un système GNU/Linux

# 0. Préparation de la machine

Accès internet machine node1:
```
[mathis@node1 ~]$ ip a
2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 08:00:27:77:04:41 brd ff:ff:ff:ff:ff:ff
    inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic noprefixroute enp0s3
       valid_lft 84503sec preferred_lft 84503sec
    inet6 fe80::a00:27ff:fe77:441/64 scope link noprefixroute
       valid_lft forever preferred_lft forever
```
```
[mathis@node1 ~]$ ping 8.8.8.8
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=114 time=26.3 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=114 time=24.4 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=114 time=22.8 ms
64 bytes from 8.8.8.8: icmp_seq=4 ttl=114 time=42.9 ms

--- 8.8.8.8 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3008ms
rtt min/avg/max/mdev = 22.791/29.093/42.872/8.052 ms
```
```
[mathis@node1 ~]$ ping google.com
PING google.com (216.58.209.238) 56(84) bytes of data.
64 bytes from par10s29-in-f238.1e100.net (216.58.209.238): icmp_seq=1 ttl=113 time=21.6 ms
64 bytes from par10s29-in-f238.1e100.net (216.58.209.238): icmp_seq=2 ttl=113 time=26.5 ms
64 bytes from par10s29-in-f238.1e100.net (216.58.209.238): icmp_seq=3 ttl=113 time=28.5 ms
64 bytes from par10s29-in-f238.1e100.net (216.58.209.238): icmp_seq=4 ttl=113 time=23.6 ms

--- google.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3006ms
rtt min/avg/max/mdev = 21.631/25.043/28.480/2.630 ms
```

Accès internet machine node2:

```
[mathis@node2 ~]$ ip a
2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 08:00:27:73:19:af brd ff:ff:ff:ff:ff:ff
    inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic noprefixroute enp0s3
       valid_lft 86345sec preferred_lft 86345sec
    inet6 fe80::a00:27ff:fe73:19af/64 scope link noprefixroute
       valid_lft forever preferred_lft forever
```
```
[mathis@node2 ~]$ ping 8.8.8.8
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=114 time=18.8 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=114 time=21.6 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=114 time=20.10 ms
64 bytes from 8.8.8.8: icmp_seq=4 ttl=114 time=22.7 ms

--- 8.8.8.8 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3007ms
rtt min/avg/max/mdev = 18.825/21.046/22.737/1.429 ms
```
```
[mathis@node2 ~]$ ping google.com
PING google.com (216.58.209.238) 56(84) bytes of data.
64 bytes from par10s29-in-f238.1e100.net (216.58.209.238): icmp_seq=1 ttl=113 time=21.2 ms
64 bytes from par10s29-in-f238.1e100.net (216.58.209.238): icmp_seq=2 ttl=113 time=25.6 ms
64 bytes from par10s29-in-f238.1e100.net (216.58.209.238): icmp_seq=3 ttl=113 time=29.1 ms
64 bytes from par10s29-in-f238.1e100.net (216.58.209.238): icmp_seq=4 ttl=113 time=24.2 ms

--- google.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3006ms
rtt min/avg/max/mdev = 21.200/25.028/29.101/2.839 ms
```


Accès réseau local:

Ping depuis node1 vers node2:
```
[mathis@node1 ~]$ ping 10.101.1.12
PING 10.101.1.12 (10.101.1.12) 56(84) bytes of data.
64 bytes from 10.101.1.12: icmp_seq=1 ttl=64 time=1.51 ms
64 bytes from 10.101.1.12: icmp_seq=2 ttl=64 time=1.25 ms
64 bytes from 10.101.1.12: icmp_seq=3 ttl=64 time=1.83 ms
64 bytes from 10.101.1.12: icmp_seq=4 ttl=64 time=1.91 ms

--- 10.101.1.12 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3007ms
rtt min/avg/max/mdev = 1.248/1.625/1.913/0.266 ms
```

Ping depuis node2 vers node1:
```
[mathis@node2 ~]$ ping 10.101.1.11
PING 10.101.1.11 (10.101.1.11) 56(84) bytes of data.
64 bytes from 10.101.1.11: icmp_seq=1 ttl=64 time=1.54 ms
64 bytes from 10.101.1.11: icmp_seq=2 ttl=64 time=1.82 ms
64 bytes from 10.101.1.11: icmp_seq=3 ttl=64 time=1.17 ms
64 bytes from 10.101.1.11: icmp_seq=4 ttl=64 time=1.50 ms

--- 10.101.1.11 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3008ms
rtt min/avg/max/mdev = 1.174/1.509/1.822/0.231 ms
```

[mathis@node1 ~]$ sudo nano /etc/hostname

Les noms de mes machines avaient déjà été modifiés auparavant, j'ai du reprendre le TP à 0 à cause d'un souci de VMs.

aperçu du DNS sur node1 (idem pour node2)
```
# Generated by NetworkManager
search auvence.co net1.tp2
nameserver 10.33.10.2
nameserver 10.33.10.148
nameserver 10.33.10.155
# NOTE: the libc resolver may not support more than 3 nameservers.
# The nameservers listed below may not be recognized.
nameserver 1.1.1.1
```
```
[mathis@node1 ~]$ dig ynov.com

;; QUESTION SECTION:
;ynov.com.                      IN      A

;; ANSWER SECTION:
ynov.com.               8423    IN      A       92.243.16.143
;; SERVER: 10.33.10.2#53(10.33.10.2)
```

```
[mathis@node2 ~]$ dig ynov.com

;; QUESTION SECTION:
;ynov.com.                      IN      A

;; ANSWER SECTION:
ynov.com.               8100    IN      A       92.243.16.143
;; SERVER: 10.33.10.2#53(10.33.10.2)
```

modification du fichier hosts:

Sur Node2:
```
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
10.101.1.11 node1 node1.tp1.b2
```

Sur Node1:
```
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
10.101.1.12 node2 node2.tp1.b2
```

Suite aux modifications précédentes,
ping de node1 vers node2:
```
[mathis@node1 ~]$ [mathis@node1 ~]$ ping node2.tp1.b2
PING node2 (10.101.1.12) 56(84) bytes of data.
64 bytes from node2 (10.101.1.12): icmp_seq=1 ttl=64 time=1.50 ms
64 bytes from node2 (10.101.1.12): icmp_seq=2 ttl=64 time=2.25 ms
64 bytes from node2 (10.101.1.12): icmp_seq=3 ttl=64 time=1.69 ms
64 bytes from node2 (10.101.1.12): icmp_seq=4 ttl=64 time=1.68 ms

--- node2 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3007ms
rtt min/avg/max/mdev = 1.495/1.777/2.249/0.283 ms
```

ping de node2 vers node1:
```
[mathis@node2 ~]$ ping node1.tp1.b2
PING node1 (10.101.1.11) 56(84) bytes of data.
64 bytes from node1 (10.101.1.11): icmp_seq=1 ttl=64 time=1.71 ms
64 bytes from node1 (10.101.1.11): icmp_seq=2 ttl=64 time=3.23 ms
64 bytes from node1 (10.101.1.11): icmp_seq=3 ttl=64 time=2.58 ms
64 bytes from node1 (10.101.1.11): icmp_seq=4 ttl=64 time=1.94 ms

--- node1 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3007ms
rtt min/avg/max/mdev = 1.713/2.363/3.225/0.591 ms
```

firewall-cmd (résultat identique sur les 2 machines)
```
[mathis@node1 ~]$ sudo firewall-cmd --list-all
[sudo] password for mathis:
public (active)
  target: default
  icmp-block-inversion: no
  interfaces: enp0s3 enp0s8
  sources:
  services: cockpit dhcpv6-client ssh
  ports:
  protocols:
  masquerade: no
  forward-ports:
  source-ports:
  icmp-blocks:
  rich rules:
```

# I. Utilisateurs

# 1. Création et configuration

ajout d'un nouvel utilisateur:
```
[mathis@node1 ~]$ sudo useradd mathis2 -m -s /bin/bash
```

vérification de l'ajout de l'utilisateur "mathis2":
```
[mathis@node1 ~]$ cd /home
[mathis@node1 home]$ ls
mathis  mathis2
```

```
[mathis@node1 bin]$ sudo cat /etc/passwd
mathis2:x:1002:1002::/home/mathis2:/bin/bash
```

Création  du groupe admins:

```
[mathis@node1 ~]$ groupadd admins
```

Dans /etc/ faire la commande suivante:

```
[mathis@node1 etc]$ cat group
admins:x:1003:
```

Le groupe admins a donc bien été créé.

```[mathis@node1 etc]$ sudo visudo sudoers ```

Copier la ligne...
```%wheel  ALL=(ALL)       ALL ```

et remplacer "wheel" par le nom de notre nouveau groupe "admins".
```%admins  ALL=(ALL)       ALL```

Ajout du nouvel user au group admins:

```
[mathis@node1 ~]$ sudo usermod -aG admins mathis2
[mathis@node1 ~]$ groups mathis2
mathis2 : mathis2 admins
```

# 2. SSH

